{"version":3,"file":"js/role-list.42963d41.js","mappings":"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","sources":["webpack://vue3-admin-common/./src/api/permission.js","webpack://vue3-admin-common/./src/api/role.js","webpack://vue3-admin-common/./src/views/role-list/components/DistributePermission.vue","webpack://vue3-admin-common/./src/views/role-list/components/DistributePermission.vue?4fbf","webpack://vue3-admin-common/./src/views/role-list/index.vue","webpack://vue3-admin-common/./src/views/role-list/index.vue?fc52"],"sourcesContent":["import request from '@/utils/request';\n\n// 获取所有权限\nexport const getPermissionList = () => {\n    return request({\n        url: '/permission/list'\n    });\n};\n","import request from '@/utils/request';\n\n// 获取所有角色\nexport const getRoleList = () => {\n    return request({\n        url: '/role/list'\n    });\n};\n\n// 获取当前角色对应的权限\nexport const rolePermission = (roleId) => {\n    return request({\n        url: `/role/permission/${roleId}`\n    });\n};\n\n// 分配权限\nexport const distributePermission = (data) => {\n    return request({\n        url: `/role/distribute-permission`,\n        method: 'POST',\n        data\n    });\n};\n","<template>\n    <el-dialog\n        :title=\"$t('msg.excel.roleDialogTitle')\"\n        :model-value=\"modelValue\"\n        @close=\"closed\"\n    >\n        <el-tree\n            ref=\"treeRef\"\n            :data=\"allPermission\"\n            :props=\"defaultProps\"\n            node-key=\"id\"\n            show-checkbox\n            check-strictly\n            default-expand-all\n        ></el-tree>\n\n        <template #footer>\n            <span class=\"dialog-footer\">\n                <el-button @click=\"closed\">{{\n                    $t('msg.universal.cancel')\n                }}</el-button>\n                <el-button type=\"primary\" @click=\"onConfirm\">{{\n                    $t('msg.universal.confirm')\n                }}</el-button>\n            </span>\n        </template>\n    </el-dialog>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue';\nimport { getPermissionList } from '@/api/permission';\nimport { rolePermission, distributePermission } from '@/api/role';\nimport { watchSwitchLang } from '@/utils/i18n';\nimport { ElMessage } from 'element-plus';\nimport { useI18n } from 'vue-i18n';\n\nconst props = defineProps({\n    modelValue: {\n        type: Boolean,\n        required: true\n    },\n    roleId: {\n        type: String,\n        required: true\n    }\n});\n\nconst allPermission = ref([]);\nconst getPermissions = async () => {\n    try {\n        allPermission.value = await getPermissionList();\n    } catch (error) {\n        allPermission.value = [\n            {\n                id: '1',\n                permissionName: '员工管理',\n                permissionMark: 'userManage',\n                permissionDesc: '员工管理菜单',\n                children: [\n                    {\n                        id: '1-1',\n                        permissionName: '分配角色',\n                        permissionMark: 'distributeRole',\n                        permissionDesc: '为员工分配角色'\n                    },\n                    {\n                        id: '1-2',\n                        permissionName: '导入员工',\n                        permissionMark: 'importUser',\n                        permissionDesc: '通过 excel 导入员工'\n                    },\n                    {\n                        id: '1-3',\n                        permissionName: '删除员工',\n                        permissionMark: 'removeUser',\n                        permissionDesc: '删除员工'\n                    }\n                ]\n            },\n            {\n                id: '2',\n                permissionName: '角色列表',\n                permissionMark: 'roleList',\n                permissionDesc: '角色列表菜单',\n                children: [\n                    {\n                        id: '2-1',\n                        permissionName: '分配权限',\n                        permissionMark: 'distributePermission',\n                        permissionDesc: '为角色分配权限'\n                    }\n                ]\n            },\n            {\n                id: '3',\n                permissionName: '权限列表',\n                permissionMark: 'permissionList',\n                permissionDesc: '权限列表菜单',\n                children: []\n            },\n            {\n                id: '4',\n                permissionName: '文章排名',\n                permissionMark: 'articleRanking',\n                permissionDesc: '文章排名菜单',\n                children: []\n            },\n            {\n                id: '5',\n                permissionName: '创建文章',\n                permissionMark: 'articleCreate',\n                permissionDesc: '创建文章页面',\n                children: []\n            }\n        ];\n    }\n};\ngetPermissions();\nwatchSwitchLang(getPermissions);\n\n// ref\nconst treeRef = ref(null);\n// 属性结构配置\nconst defaultProps = {\n    children: 'children',\n    label: 'permissionName'\n};\n\n// 当前角色的权限\nconst getRolePermission = async () => {\n    try {\n        const checkedKeys = await rolePermission(props.roleId);\n        treeRef.value.setCheckedKeys(checkedKeys);\n    } catch (error) {\n        const checkedKeys = [\n            '1',\n            '1-1',\n            '1-2',\n            '1-3',\n            '2',\n            '2-1',\n            '3',\n            '4',\n            '5'\n        ];\n        treeRef.value.setCheckedKeys(checkedKeys);\n    }\n};\nwatch(\n    () => props.roleId,\n    (value) => {\n        if (value) getRolePermission();\n    }\n);\n\nconst emits = defineEmits(['update:modelValue']);\n\n/**\n    确定按钮点击事件\n   */\nconst i18n = useI18n();\nconst onConfirm = async () => {\n    // 分配权限\n    try {\n        await distributePermission({\n            roleId: props.roleId,\n            permissions: treeRef.value.getCheckedKeys()\n        });\n        ElMessage.success(i18n.t('msg.role.updateRoleSuccess'));\n    } catch (error) {\n        ElMessage.success(i18n.t('msg.role.updateRoleSuccess'));\n    }\n    closed();\n};\n\n/**\n * 关闭\n */\nconst closed = () => {\n    emits('update:modelValue', false);\n};\n</script>\n","import script from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"\">\n        <el-card>\n            <el-table :data=\"allRoles\" border width=\"100%\">\n                <el-table-column\n                    :label=\"$t('msg.role.index')\"\n                    type=\"index\"\n                    width=\"120\"\n                >\n                </el-table-column>\n                <el-table-column :label=\"$t('msg.role.name')\" prop=\"title\">\n                </el-table-column>\n                <el-table-column :label=\"$t('msg.role.desc')\" prop=\"describe\">\n                </el-table-column>\n                <el-table-column\n                    :label=\"$t('msg.role.action')\"\n                    prop=\"action\"\n                    width=\"260\"\n                    #default=\"{ row }\"\n                >\n                    <el-button\n                        v-permission=\"['distributePermission']\"\n                        type=\"primary\"\n                        size=\"mini\"\n                        @click=\"onDistributePermissionClick(row)\"\n                    >\n                        {{ $t('msg.role.assignPermissions') }}\n                    </el-button>\n                </el-table-column>\n            </el-table>\n        </el-card>\n\n        <DistributePermission\n            v-model=\"visible\"\n            :roleId=\"selectRoleId\"\n        ></DistributePermission>\n    </div>\n</template>\n\n<script setup>\nimport { getRoleList } from '@/api/role';\nimport { watchSwitchLang } from '@/utils/i18n';\nimport { ref, watch } from 'vue';\nimport DistributePermission from './components/DistributePermission';\n\nconst allRoles = ref([]);\nconst getRoles = async () => {\n    try {\n        allRoles.value = await getRoleList();\n    } catch (error) {\n        allRoles.value = [\n            {\n                id: '1',\n                title: '超级管理员',\n                describe: '唯一账号，可以操作系统所有功能'\n            },\n            {\n                id: '2',\n                title: '管理员',\n                describe: '由超管指定，可以为多个，协助超管管理系统'\n            },\n            {\n                id: '3',\n                title: '人事经理',\n                describe: '主管人事相关业务'\n            },\n            {\n                id: '4',\n                title: '销售经理',\n                describe: '主管销售相关业务'\n            },\n            {\n                id: '5',\n                title: '保安队长',\n                describe: '主管安保相关业务'\n            },\n            {\n                id: '6',\n                title: '员工',\n                describe: '普通员工'\n            }\n        ];\n    }\n};\ngetRoles();\nwatchSwitchLang(getRoles);\n\nconst visible = ref(false);\nconst selectRoleId = ref('');\nconst onDistributePermissionClick = (row) => {\n    visible.value = true;\n    selectRoleId.value = row.id;\n};\n\nwatch(visible, (value) => {\n    if (!value) selectRoleId.value = '';\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getPermissionList","request","url","getRoleList","rolePermission","roleId","distributePermission","data","method","allPermission","ref","getPermissions","async","value","error","id","permissionName","permissionMark","permissionDesc","children","watchSwitchLang","treeRef","defaultProps","label","getRolePermission","checkedKeys","props","setCheckedKeys","watch","i18n","useI18n","onConfirm","permissions","getCheckedKeys","ElMessage","t","closed","emits","__exports__","allRoles","getRoles","title","describe","visible","selectRoleId","onDistributePermissionClick","row"],"sourceRoot":""}