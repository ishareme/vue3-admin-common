"use strict";(self["webpackChunkvue3_admin_common"]=self["webpackChunkvue3_admin_common"]||[]).push([[474],{1033:function(e,i,s){s.d(i,{p:function(){return l}});var r=s(4471);const l=()=>(0,r.Z)({url:"/permission/list"})},730:function(e,i,s){s.d(i,{JV:function(){return l},b6:function(){return t},hg:function(){return n}});var r=s(4471);const l=()=>(0,r.Z)({url:"/role/list"}),t=e=>(0,r.Z)({url:`/role/permission/${e}`}),n=e=>(0,r.Z)({url:"/role/distribute-permission",method:"POST",data:e})},1379:function(e,i,s){s.r(i),s.d(i,{default:function(){return w}});var r=s(3396),l=s(7139),t=s(4870),n=s(730),a=s(3188),o=s(1033),c=s(858),u=s(2762);const m={class:"dialog-footer"};var d={__name:"DistributePermission",props:{modelValue:{type:Boolean,required:!0},roleId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:i}){const s=e,d=(0,t.iH)([]),p=async()=>{try{d.value=await(0,o.p)()}catch(e){d.value=[{id:"1",permissionName:"员工管理",permissionMark:"userManage",permissionDesc:"员工管理菜单",children:[{id:"1-1",permissionName:"分配角色",permissionMark:"distributeRole",permissionDesc:"为员工分配角色"},{id:"1-2",permissionName:"导入员工",permissionMark:"importUser",permissionDesc:"通过 excel 导入员工"},{id:"1-3",permissionName:"删除员工",permissionMark:"removeUser",permissionDesc:"删除员工"}]},{id:"2",permissionName:"角色列表",permissionMark:"roleList",permissionDesc:"角色列表菜单",children:[{id:"2-1",permissionName:"分配权限",permissionMark:"distributePermission",permissionDesc:"为角色分配权限"}]},{id:"3",permissionName:"权限列表",permissionMark:"permissionList",permissionDesc:"权限列表菜单",children:[]},{id:"4",permissionName:"文章排名",permissionMark:"articleRanking",permissionDesc:"文章排名菜单",children:[]},{id:"5",permissionName:"创建文章",permissionMark:"articleCreate",permissionDesc:"创建文章页面",children:[]}]}};p(),(0,a.K)(p);const b=(0,t.iH)(null),v={children:"children",label:"permissionName"},k=async()=>{try{const e=await(0,n.b6)(s.roleId);b.value.setCheckedKeys(e)}catch(e){const i=["1","1-1","1-2","1-3","2","2-1","3","4","5"];b.value.setCheckedKeys(i)}};(0,r.YP)((()=>s.roleId),(e=>{e&&k()}));const h=(0,u.QT)(),w=async()=>{try{await(0,n.hg)({roleId:s.roleId,permissions:b.value.getCheckedKeys()}),c.z8.success(h.t("msg.role.updateRoleSuccess"))}catch(e){c.z8.success(h.t("msg.role.updateRoleSuccess"))}f()},f=()=>{i("update:modelValue",!1)};return(i,s)=>{const t=(0,r.up)("el-tree"),n=(0,r.up)("el-button"),a=(0,r.up)("el-dialog");return(0,r.wg)(),(0,r.j4)(a,{title:i.$t("msg.excel.roleDialogTitle"),"model-value":e.modelValue,onClose:f},{footer:(0,r.w5)((()=>[(0,r._)("span",m,[(0,r.Wm)(n,{onClick:f},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(i.$t("msg.universal.cancel")),1)])),_:1}),(0,r.Wm)(n,{type:"primary",onClick:w},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(i.$t("msg.universal.confirm")),1)])),_:1})])])),default:(0,r.w5)((()=>[(0,r.Wm)(t,{ref_key:"treeRef",ref:b,data:d.value,props:v,"node-key":"id","show-checkbox":"","check-strictly":"","default-expand-all":""},null,8,["data"])])),_:1},8,["title","model-value"])}}};const p=d;var b=p;const v={class:""};var k={__name:"index",setup(e){const i=(0,t.iH)([]),s=async()=>{try{i.value=await(0,n.JV)()}catch(e){i.value=[{id:"1",title:"超级管理员",describe:"唯一账号，可以操作系统所有功能"},{id:"2",title:"管理员",describe:"由超管指定，可以为多个，协助超管管理系统"},{id:"3",title:"人事经理",describe:"主管人事相关业务"},{id:"4",title:"销售经理",describe:"主管销售相关业务"},{id:"5",title:"保安队长",describe:"主管安保相关业务"},{id:"6",title:"员工",describe:"普通员工"}]}};s(),(0,a.K)(s);const o=(0,t.iH)(!1),c=(0,t.iH)(""),u=e=>{o.value=!0,c.value=e.id};return(0,r.YP)(o,(e=>{e||(c.value="")})),(e,s)=>{const n=(0,r.up)("el-table-column"),a=(0,r.up)("el-button"),m=(0,r.up)("el-table"),d=(0,r.up)("el-card"),p=(0,r.Q2)("permission");return(0,r.wg)(),(0,r.iD)("div",v,[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(m,{data:i.value,border:"",width:"100%"},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{label:e.$t("msg.role.index"),type:"index",width:"120"},null,8,["label"]),(0,r.Wm)(n,{label:e.$t("msg.role.name"),prop:"title"},null,8,["label"]),(0,r.Wm)(n,{label:e.$t("msg.role.desc"),prop:"describe"},null,8,["label"]),(0,r.Wm)(n,{label:e.$t("msg.role.action"),prop:"action",width:"260"},{default:(0,r.w5)((({row:i})=>[(0,r.wy)(((0,r.wg)(),(0,r.j4)(a,{type:"primary",size:"mini",onClick:e=>u(i)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(e.$t("msg.role.assignPermissions")),1)])),_:2},1032,["onClick"])),[[p,["distributePermission"]]])])),_:1},8,["label"])])),_:1},8,["data"])])),_:1}),(0,r.Wm)((0,t.SU)(b),{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),roleId:c.value},null,8,["modelValue","roleId"])])}}};const h=k;var w=h}}]);
//# sourceMappingURL=role-list.42963d41.js.map